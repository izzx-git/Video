Видео плеер для ZS GMX+HDD/SD+GS/Covox от izzx

Проигрывает форматы:
GMV (160*200) - 10 кадр/с, 16140 герц моно
GMM (640*200) - 5 кадр/с, 11025 герц моно - Временно отключен
ZXV (256*192) - 10 кадр/с, 22050 герц моно - Временно отключен

Тема на форуме:
https://zx-pk.ru/threads/33885-video-dlya-zs-gmx.html?p=1135818#post1135818

Плеер основан на коде, взятом из:
FATALL v 0.25 (by savelij) - Драйверы FAT
VidevoPluer v2.14.45e (by DimkaM) - Вывод на Covox
Спасибо авторам за код, а также участникам форума за помощь.

Воспроизводится с FAT32 раздела.
Драйвер от FATALL переделан на открытые порты SMUC.
Работает на SD ZC,  HDD Smuc (с открытими портами).
HDD Nemo с GMX не работает.
NGS SD отключен.
Для этой версии плеера файлы не должны быть фрагментированы. 
Если свободного места на диске достаточно, то фрагментации, скорее всего, не будет.
Плеер отображает максимум 255 файлов в папке.

Запуск:
Видео файлы положить в раздел FAT.
Запустить DISK.TRD.

Видео подготавливается автоматически с помощью vid2zx.bat (в отдельной папке).


Как подготовить ролик (ниже старая инструкция для истории):
(в скобках указаны параметры для GMM)
1. Из видео файла выгрузить звук в формат WAV (в VLC).
2. Преобразовать звук в формат 22050 (11025) Гц, 8 бит, моно (в Free Audio Editor 2016).
Возможно, скорость звука придётся немного подгонять (кнопка Speed Change). 
Например, сделать 99%. Но качество может пострадать.
3. Видео сделать частотой кадров кратной 10, например 30 (в Киностудии),
затем, сохранить в картинки с частотой 10 (5) кадр/с.
(в VLC задать сохранить каждый 3 (6) кадр, если всего 30 кадров).
Возможно, частоту кадров придётся подгонять, если не менять скорость звука.
4. Сконвертировать картинки в формат GMX 160*200 (640*200) или ZX (256*192)
(в Dadither выбрать формат, Fit result in source, затем обработка Batch Convert).
5. Склеить в один файл утилитой GMV_Join.exe.
Например: gmv_join scene sound.wav 27 gmv
Или так: gmv_join scene sound.wav 27 gmm
Или так: gmv_join scene sound.wav 27 zxv
Где:
scene - имя картинок. 
Утилита будет искать файлы с именем от scene00000.C до scene99999.C (.scr для ZX)
sound.wav - файл звука.
27 - Пауза в кадрах перед началом изображения, для синхронизации звука (заполняется буфер). 
Чем меньше, тем раньше появится картинка. К концу ролика может быть рассинхрон. 
Тогда нужно менять скорость звука или частоту кадров.
gmv (gmm, zxv) - Формат
На выходе будет файл VIDEO.GMV (.GMM, .ZXV).


Формат кадра видео:
4096 байт - звук (заполнен не весь)
16384 (32768, 8192) - картинка


Ссылки:

Конвертер картинок:
https://zx-pk.ru/threads/32400-dadither-eshche-odna-programka-dlya-dither-ga-kartinok.html?highlight=dadither

Как сохранить видео в картинки (через VLC):
https://culhu.ru/archives/25746

Как сохранить звук из видео (через VLC):
https://toadmin.ru/%D0%BA%D0%B0%D0%BA-%D0%B8%D0%B7%D0%B2%D0%BB%D0%B5%D1%87%D1%8C-%D0%BD%D0%B5%D1%81%D0%BA%D0%BE%D0%BB%D1%8C%D0%BA%D0%BE-%D0%B7%D0%B2%D1%83%D0%BA%D0%BE%D0%B2%D1%8B%D1%85-%D0%B4%D0%BE%D1%80%D0%BE%D0%B6/


Скорости на чтение примерно такие:
ZC - 258048 байт/с (16 кадр/с по 16128 байт)
SMUC через 3d2f - 44491 байт/с (2,7 кадр/с)
SMUC через открытые порты - примерно равно ZC.
